## 文件IO
> 均为**不带缓冲的`I/O`**，即每次调用都会触发一次系统调用 \
> 对于内核而言，所有打开的文件都通过**文件描述符**(非负整数)引用
``` 
fd 0 → stdin
fd 1 → stdout
fd 2 → stderr

shell中 重定向符号 
< 默认作用于标准输入（fd=0)
> 默认作用于标准输出（fd=1）
```
---
### 1. `open` 函数
```c
#include <fcntl.h>
int open (const char *__path, int __oflag, ...);
```
>`retuen` -1打开失败 否则文件描述符
- `O_WDNOLY` 只读
- `O_RDNOLY` 只写
- `O_RDWR`   读写

可追加

- `O_APPEND`
- `O_CREAT`
- `O_TRUNC`
---

### 2. `creat` 函数 
```c
#include <fcntl.h>
int creat (const char *__file, mode_t __mode);
```
>`retuen` -1创建失败 否则文件描述符

---
### 3. `close` 函数
```c
#include <unistd.h>
int close (int __fd);
```
>`retuen` -1关闭失败 0成功

---
### 4. `lseek` 函数
```c
#include <unistd.h>
__off_t lseek (int __fd, __off_t __offset, int __whence);
```
>`retuen` -1关闭失败 否则文件偏移量

`whence`
- `SEEK_SET` 距文件开始`offest`个字节
- `SEEK_CUR` 距文件当前`offest`个字节
- `SEEK_END` 文件长度`offest`个字节
---
### 5. `read` 函数
```c
#include <unistd.h>
read (int __fd, void *__buf, size_t __nbytes);
```
>`retuen` -1读失败 0读到文件尾 否则已读字节数

---
### 6. `write` 函数
```c
ssize_t write (int __fd, const void *__buf, size_t __n);
```

>`retuen` -1写失败 否则已写字节数
---
### 空洞实验
>文件系统以“块”为单位分配空间
如 ext4 ：
block size = 4KB

![alt text](./imgs/1.png)
---
### IO文件共享


---